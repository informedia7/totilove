-- Add cleared_at column to users_deleted_receivers table
-- This allows tracking which receivers have cleared which deleted users
-- without needing a separate table

ALTER TABLE users_deleted_receivers 
ADD COLUMN IF NOT EXISTS cleared_at TIMESTAMP NULL;

-- Add index for faster lookups of non-cleared entries
CREATE INDEX IF NOT EXISTS idx_users_deleted_receivers_not_cleared 
ON users_deleted_receivers(receiver_id, deleted_user_id) 
WHERE cleared_at IS NULL;

-- Add comment
COMMENT ON COLUMN users_deleted_receivers.cleared_at IS 'Timestamp when this receiver cleared this deleted user from their conversation list. NULL means not cleared.';





























































































































































































